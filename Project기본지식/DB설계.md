# DB 설계

## 1. DB 설계의 목적

- 프로젝트, 명세서 등의 정보 요구사항에 대한 정확한 이해
- 분석자, 개발자, 사용자간의 원활한 의사소통 수단
- 데이터 중심의 분석 방법
- 현행 시스템만이 아닌 신규 시스템 개발의 기초 제공

## 2. 설계를 위한 요구사항 분석

- 데이터베이스에 대한 사용자의 요구사항을 수집하고 분석 -> 요구사항 명세서 작성
- ex) 회원 가입에는 아이디, 비밀번호, 성명이 필요하다 ...

## 3. 개념적 설계

- 작성한 요구사항 명세서에서 데이터베이스를 구성하는데 필요한 개체, 속성, 개체 간 관계를 추출하여 ERD 작성

1. 개체와 속성 추출(대부분 명사로)
   - 개체: 회원, 신용카드, 비행기, 비행기 좌석 등
   - 속성: 아이디, 비밀번호, 성명, 유효기간, 비행기 번호, 좌석 번호, 등급 등
2. 개체 간의 관계 추출

   - 회원의 신용카드 정보는 여러개 저장 가능(1:N)
   - 회원 한 명은 좌석을 하나만 예약 가능(1:1)
   - 한 좌석은 회원 한 명만 예약 가능(1:1)

3. 개념 설계 기반으로 ERD 생성

   - 개체는 네모, 속성은 동그라미, 관계는 다이아몬드로 표시 [개체 기본 도형 참고 페이지](https://moonibot.tistory.com/21)

4. N:M 관계는 릴레이션(Table)으로 변환

   - 관계 -> 릴레이션 이름, 관계속성 -> 릴레이션 속성

5. 1:N 관계는 외래키로 표현

   - 일반적으로 1:N 관계에서 1측 개체의 기본키를 N측 릴레이션에 포함시키고 외래키로 지정

6. 1:1 관계는 외래키로 표현

   - 일반적 1:1 관계는 외래키를 서로 주고 받는다

7. 다중값 속성은 독립 릴레이션으로

   - 릴레이션에서는 다중 값 속성을 가질 수 없으므로 다중 값 속성은 별도의 릴레이션으로 생성

8. 물리적 스키마 및 구현
   - ERD를 실제 테이블로 생성

## DB 정규화

- 데이터 모델의 중복을 최소화하고 데이터의 일관성, 유연성을 확보하기 위한 목적으로 데이터를 분해하는 과정
- 현업에서는 3 정규화 정도까지 주로 사용(7정규화까지 존재)

#### 반정규화(역정규화)

- 정규화된 엔티티타입, 속성, 관계를 시스템의 성능향상, 개발과 운영의 단순화를 위해 모델을 통합하는 프로세스
- 정규화의 단점인 SQL 작성이 용이하지 않고 과다한 테이블 조인으로 인한 성능 저하를 어느정도 해소하기 위함
- 하지만 같은 데이터가 여러 테이블에 걸쳐 존재하므로 무결성이 깨질 우려가 있음

#### 테이블 반정규화 방법

- 1:1 관계의 테이블 병합
- 1:N 관계의 테이블 병합
- 수퍼/서브 타입 테이블 병합
- 수직 분할(집중화된 일부 컬럼을 분리)
- 수평 분할(행으로 구분하여 구간별 분리)
- 테이블 추가(중복, 통계, 이력, 부분 테이블)

#### 대표적 반정규화 - 컬럼 반정규화

- 중복컬럼 추가(자주 조회하는 컬럼)
- 파생 컬럼 추가(미리 계산한 값)
- PK에 의한 컬럼 추가
- 응용시스템 오작동을 위한 컬럼 추가

#### 대표적 반정규화 - 관계 반정규화

- 중복 관계 추가(이미 A 테이블에서 C 테이블의 정보를 읽을 수 있지만, 관계를 중복하여 조회 경로를 단축)

#### 결론 - 반정규화가 무엇이냐!

- 데이터베이스의 성능 향상을 위하여, 데이터 중복을 허용하고 조인을 줄이는 데이터베이스 성능 향상 방법이다.
