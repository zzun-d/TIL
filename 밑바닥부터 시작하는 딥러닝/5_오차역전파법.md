# 5. 오차역전파법(backpropagation)
---
- 오차역전파법을 이해하기 쉽게 계산 그래프로 풀어보자

## 5.1 계산 그래프
- 계산 그래프는 복수의 노드와 에지로 표현된다
- 노드는 연산내용, 에지는 연산 방향을 의미한다
- 책에 나오는 그림을 보면서 이해하면 쉽다.

*문제 : 슈퍼에서 개당 100원인 사과를 2개 샀을 때 지불금액은?(단, 소비세 10%)*

먼저 사과의 총 가격 100원 * 2 인 200원을 구하고, 그 이후에 소비세 10%를 계산하여 220원 이라는 결과를 내게되는데, 이처럼 계산을 순차적으로 진행하는 단계를 **순전파**라고 하며, 역순으로 거슬러 올라가는 것을 **역전파**라고 한다.

### 연쇄법칙
  - 역전파ㅠ를 이해하기 위해서는 **연쇄법칙**을 이해해야 한다.
  - 연쇄법칙은 합성 함수의 미분에 대한 성질로, 아래와 같이 표현한다.
  $$z = t^2 \\ t=x+y \\ \ \\ {\partial z \over \partial x}={\partial z \over \partial t}{\partial t \over \partial x} = 2t \cdot 1=2(x+y)$$

  <br>

  - **덧셈 노드의 역전파**
    - $z=x+y$ 식을 대상으로 역전파를 살펴보자
    - 위 식의 편미분은 
    $${\partial z \over \partial x} = 1, \ \ \ {\partial z \over \partial y} = 1 $$
    - 이며, 편미분 값이 1이기 때문에 역전파의 입력 신호를 그대로 다음 노드로 전달한다

  <br>

  - **곱셈 노드의 역전파**
    - 마찬가지로 $z = xy$ 식을 대상으로 역전파를 살펴보자
    - 위 식의 편미분
    $${\partial z \over \partial x} = y, \ \ \ {\partial z \over \partial y} = x $$
    - 이며 서로 바꾼 값을 곱하여 다음 노드로 전달한다.
    - 즉 x가 입력된 노드로는 y를 곱한 값을, y가 입력된 노드로는 x를 곱한 값을 전달한다.
  
  <br>

  - **문제풀이로 이해하자**
  ![shopping ex]('github 링크 넣어주쇼')

  위 사진은 밑.시.딥 160페이지에서 소개된 예이다.
  - 덧셈노드는 그대로, 곱셈노드는 서로 바꾸어 곱한 뒤 전달하는 규칙을 적용하여 값을 넣어보자(처음 입력으로 1이 들어온다)

  <br>

  ![shopping ex 2]('github 링크 넣어주쇼2')

  - 첫 곱셈노드에서 서로 값을 바꿔 곱하여 전달하기 때문에 1 x 1.1인 1.1이 들어간다.
  - 다음 덧셈노드는 그냥 1.1을 흘려보내고
  - 각각 1.1이 두 곱셈노드로 들어간다.
  - 사과의 개수는 1.1 x 100인 110이 되고

